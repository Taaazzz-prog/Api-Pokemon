<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Nouvelles Fonctionnalit√©s Pok√©mon</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }
        .test-button {
            margin: 5px;
            padding: 10px 15px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-result {
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>üß™ Test des Nouvelles Fonctionnalit√©s</h1>
    
    <div class="test-section">
        <h2>üîß Gestionnaires Disponibles</h2>
        <div id="managers-status"></div>
    </div>

    <div class="test-section">
        <h2>‚≠ê Test Favoris</h2>
        <button class="test-button" onclick="testFavorites()">Tester les Favoris</button>
        <div id="favorites-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h2>üîÑ Test Comparateur</h2>
        <button class="test-button" onclick="testComparator()">Tester le Comparateur</button>
        <div id="comparator-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h2>üìö Test Historique</h2>
        <button class="test-button" onclick="testHistory()">Tester l'Historique</button>
        <div id="history-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h2>üñºÔ∏è Test Optimisation</h2>
        <button class="test-button" onclick="testOptimizers()">Tester les Optimiseurs</button>
        <div id="optimizers-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h2>üéØ Navigation vers les Pages</h2>
        <button class="test-button" onclick="window.location.href='liste.html'">üìã Aller au Pok√©dex</button>
        <button class="test-button" onclick="window.location.href='generation.html'">üî¢ Aller aux G√©n√©rations</button>
        <button class="test-button" onclick="window.location.href='index.html'">üè† Retour Accueil</button>
        <div class="test-result">
            <strong>üí° Astuce :</strong> Sur les pages Pok√©dex et G√©n√©rations, survolez les cartes pour voir les boutons ‚≠ê et ‚öñÔ∏è
        </div>
    </div>

    <!-- Scripts -->
    <script src="favorites.js"></script>
    <script src="pokemon-comparator.js"></script>
    <script src="search-history.js"></script>
    <script src="image-optimizer.js"></script>
    <script src="asset-minifier.js"></script>
    <!-- CDN Manager temporairement d√©sactiv√© -->
    <!-- <script src="cdn-manager.js"></script> -->
    <script src="app-initializer.js"></script>
    
    <script>
        // V√©rifier les gestionnaires au chargement
        window.addEventListener('DOMContentLoaded', function() {
            setTimeout(checkManagers, 500);
        });

        function checkManagers() {
            const statusDiv = document.getElementById('managers-status');
            const managers = [
                { name: 'Favoris', instance: 'favoritesManager', class: 'FavoritesManager' },
                { name: 'Comparateur', instance: 'pokemonComparator', class: 'PokemonComparator' },
                { name: 'Historique', instance: 'searchHistoryManager', class: 'SearchHistoryManager' },
                { name: 'Optimiseur Images', instance: 'imageOptimizer', class: 'ImageOptimizer' },
                { name: 'Minificateur', instance: 'assetMinifier', class: 'AssetMinifier' },
                { name: 'CDN (D√©sactiv√©)', instance: 'cdnManager', class: 'CDNManager' }
            ];

            let html = '<ul>';
            managers.forEach(manager => {
                const available = window[manager.instance] ? '‚úÖ' : '‚ùå';
                const classExists = typeof window[manager.class] !== 'undefined' ? '‚úÖ' : '‚ùå';
                const status = manager.name.includes('CDN') ? ' (Volontairement d√©sactiv√©)' : '';
                html += `<li><strong>${manager.name}:</strong> Instance ${available} | Classe ${classExists}${status}</li>`;
            });
            html += '</ul>';
            html += '<p><strong>Note :</strong> Le CDN Manager est temporairement d√©sactiv√© pour √©viter les erreurs 404.</p>';
            statusDiv.innerHTML = html;
        }

        function testFavorites() {
            const resultDiv = document.getElementById('favorites-result');
            if (window.favoritesManager) {
                try {
                    // Test d'ajout de favoris
                    const testPokemon = { id: 25, name: 'Pikachu', image: 'test.png' };
                    window.favoritesManager.addToFavorites(testPokemon);
                    
                    const isFav = window.favoritesManager.isFavorite(25);
                    resultDiv.innerHTML = `
                        <strong>‚úÖ Test r√©ussi !</strong><br>
                        - Pikachu ajout√© aux favoris: ${isFav ? 'Oui' : 'Non'}<br>
                        - Nombre de favoris: ${window.favoritesManager.favorites.length}
                    `;
                } catch (error) {
                    resultDiv.innerHTML = `<strong>‚ùå Erreur:</strong> ${error.message}`;
                }
            } else {
                resultDiv.innerHTML = '<strong>‚ùå Gestionnaire de favoris non disponible</strong>';
            }
        }

        function testComparator() {
            const resultDiv = document.getElementById('comparator-result');
            if (window.pokemonComparator) {
                try {
                    window.pokemonComparator.togglePokemonSelection(1);
                    window.pokemonComparator.togglePokemonSelection(4);
                    
                    resultDiv.innerHTML = `
                        <strong>‚úÖ Test r√©ussi !</strong><br>
                        - Pok√©mon s√©lectionn√©s: ${window.pokemonComparator.selectedPokemons.size}<br>
                        - IDs: ${Array.from(window.pokemonComparator.selectedPokemons).join(', ')}
                    `;
                } catch (error) {
                    resultDiv.innerHTML = `<strong>‚ùå Erreur:</strong> ${error.message}`;
                }
            } else {
                resultDiv.innerHTML = '<strong>‚ùå Comparateur non disponible</strong>';
            }
        }

        function testHistory() {
            const resultDiv = document.getElementById('history-result');
            if (window.searchHistoryManager) {
                try {
                    window.searchHistoryManager.addSearch({
                        query: 'Pikachu',
                        results: 1,
                        filters: { type: 'electric' }
                    });
                    
                    resultDiv.innerHTML = `
                        <strong>‚úÖ Test r√©ussi !</strong><br>
                        - Recherches en historique: ${window.searchHistoryManager.history.length}<br>
                        - Derni√®re recherche: ${window.searchHistoryManager.history[0]?.query || 'Aucune'}
                    `;
                } catch (error) {
                    resultDiv.innerHTML = `<strong>‚ùå Erreur:</strong> ${error.message}`;
                }
            } else {
                resultDiv.innerHTML = '<strong>‚ùå Gestionnaire d\'historique non disponible</strong>';
            }
        }

        function testOptimizers() {
            const resultDiv = document.getElementById('optimizers-result');
            const results = [];
            
            if (window.imageOptimizer) {
                results.push('‚úÖ Optimiseur d\'images');
            } else {
                results.push('‚ùå Optimiseur d\'images');
            }
            
            if (window.assetMinifier) {
                results.push('‚úÖ Minificateur d\'assets');
            } else {
                results.push('‚ùå Minificateur d\'assets');
            }
            
            if (window.cdnManager) {
                results.push('‚úÖ Gestionnaire CDN');
            } else {
                results.push('‚ùå Gestionnaire CDN');
            }
            
            resultDiv.innerHTML = results.join('<br>');
        }
    </script>
</body>
</html>